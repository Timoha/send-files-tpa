<div class="main-body" style="min-width: 255px;"ng-controller="WidgetCtrl">
  <div class="active" ng-if="!active">
    <span>
      THIS APP IS NOT YET ACTIVE.
    </span>
    <div></div>
    <span>
      Activate it by logging in within the settings.
    </span>
  </div>
  <div class="submitting" ng-if="submitting || submitted || uploadFailed">
    <span ng-if="submitting">
      Submitting...
    </span>
    <span ng-if="submitted">
      Submitted successfully!
    </span>
    <span ng-if="uploadFailed">
      {{submitErrorMessage}}
    </span>
  </div>
  <div class="overload" ng-show="showOverloadedList">
    <span class="overload-message">
      The following files can't be added due to lack of storage space:
    </span>
    <div class="list-container">
      <ul class="overload-list">
        <li ng-repeat="file in overloadedList">
          <span>{{file.name}}</span><br>
        </li>
      </ul>
    </div>
    <div class="button-container">
      <button class="buttons overload-button" ng-click="removeOverload()">OK</button>
    </div>
  </div>
  <div class="dropper" title="Drop files here" ng-file-drop="onFileSelect($files)" ng-file-drag-over-class="dropping">
    Drop files here
  </div>
  <form name="fileForm" novalidate ng-model="fileForm" ng-style="viewStyle()">
    <div ng-style="formStyle()">
      <div class="block end-blocks file-upload">
        <h2 class="title">
          {{settings.title}}This is my title.
        </h2>
        <p class="description">
          {{settings.description}}This is my description.
        </p>
        <button class="buttons" disabled>
          {{settings.addButtonText}}
        </button>
        <input type="file" title={{settings.addButtonText}} ng-file-select="onFileSelect($files)" multiple name="sendFile">
      </div>

    <!-- Note: Placeholder attribute is not supported in IE9 or below -->

      <div class="block files">
        <div class="tool-tip-container" ng-show="showNoFile">
            <span class="tool-tip">{{fileMessage}}</span>
        </div>
        <!-- Show uploading files here -->
        <!-- <div class="block">
          <ul class="list-files">
            <li ng-show="overLoadedList.length > 0">The following files can't be added due to lack of storage space:</li>
            <li ng-repeat="file in overLoadedList">
              {{file.name}} - {{file.newSize}}
            </li>
          </ul>
        </div> -->
        <ul class="list-files">
          <p ng-if="!totalFilesAdded">
            Uploaded files are displayed here.
          </p>
          <li class="display-files" ng-repeat="file in fileList" ng-if="uploadedFiles[$index] !== 'aborted'">
            <span class="file-text" ng-style="fileStyle($index)" hover>
              <a class="retry-files" href="#" ng-click="retry($index)" ng-if="progressIcons[$index] === false">.</a>
              <span class="file-info">
                {{file.name}}
              </span>
              <a class="remove" href="#" ng-click="abort($index)">.</a>
              <span class="status-text progress-text" ng-if="progressIcons[$index]=== undefined">
                {{100 - progress[$index]}}%
              </span>
            </span>
            <div style="clear: both;"></div>
            <div class="progress" ng-if="progressIcons[$index] === undefined">
              <span style="width:{{progress[$index]}}%;"></span>
            </div>
          </li>
        </ul> 
      </div>

      <div class="block input-block">
        <input name="visitorName" class="visitorName" placeholder="{{settings.yourNameText}}" ng-model="visitorName" ng-change="updateVisitorName(visitorName)" required>
        <div class="tool-tip-container" ng-show="showNoName">
            <span class="tool-tip">Please enter a name.</span>
        </div>
      </div>

      <div class="block input-block email-block">
        <input name="email" type="email" class="email" placeholder="{{settings.emailAddressText}}" required ng-model="email" ng-pattern="emailRegex" ng-change="updateEmail(email)">
        <div class="tool-tip-container" ng-show="showInvalidEmail">
            <span class="tool-tip">Please enter a valid email address</span>
        </div>
      </div>

      <div class="block user-message">
        <textarea name="message" placeholder={{settings.messageText}} required ng-model="message" class="message" ng-change="updateMessage(message)"></textarea>
         <div class="tool-tip-container-message">
            <span class="tool-tip-message" ng-show="showNoMessage">Please enter a message</span>
        </div>
        <p class= "file-statistics file-status">
          <span class="no-files" ng-if="!totalFilesAdded">
            No files uploaded
          </span>
          <span class="success-text" ng-if="totalSuccess" ng-style="successTextStyle()"> <!-- ng-if="totalSuccess" -->
            {{totalSuccess}} uploaded
          </span>
          <span class="error-text" ng-if="totalFailed" ng-style="failedTextStyle()"> <!-- ng-if="totalFailed" -->
            {{totalFailed}} failed
          </span>
          <span class="loading-text" ng-if="totalFilesAdded - totalSuccess - totalFailed" ng-style="loadingTextStyle()"> <!-- totalFilesAdded - totalSuccess - totalFailed -->
            {{totalFilesAdded - totalSuccess - totalFailed}} loading...
          </span>
          <span class="file-upload-message" ng-show="showFileUploadMessage">
            {{fileUploadMessage}}
          </span>
        </p>
      </div>
    </div>

    <div class="block end-blocks submit">
      <button class="buttons bottom-buttons"  type="submit" ng-disabled="submitNotReady()" ng-click="submit()" ng-if="!uploadFailed">
        <span ng-show="!submitting">{{settings.submitButtonText}}</span>
        <span ng-show="submitting">Submitting...</span>
      </button>
      <div class="submit-container" ng-mouseover="enableErrorMessage()" ng-mouseleave="disableErrorMessage()" ng-show="submitNotReady()"> 
        <!-- Invisible element that surrounds Submit Button - allows mouse events when button disabled -->
      </div>
    </div>
    <div class="failure-end end-blocks" ng-show="uploadFailed">
      <button class="buttons bottom-buttons" type="button" ng-click="submit()">Retry</button>
      <button class="buttons bottom-buttons" type="reset" ng-click="reset()">Cancel</button>
    </div>
  </form>
</div>

